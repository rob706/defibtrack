RewriteEngine On
RewriteBase /

<FilesMatch “\.(htaccess|htpasswd|ini|eps|log|sh|xcf|pg)$”>
Deny from all
</FilesMatch>

## Send to https ##

RewriteCond %{HTTP_HOST} !^127\. [NC]
RewriteCond %{HTTPS} !=on [NC]
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

## Lock Directories ##

Options -Indexes -MultiViews +FollowSymlinks

####### House Keeping #######

## Error Pages ##

ErrorDocument 401 /error.php?error=401
ErrorDocument 403 /error.php?error=403
ErrorDocument 404 /error.php?error=404
ErrorDocument 500 /error.php?error=500

####### Clean URLS #######

RewriteRule ^([^/\.]+).htm?$ index.php?pg=$1 [L]
RewriteRule ^images/([^/\.]+).([^/\.]+)?$ core/img-view.php?pic=$1&ext=$2